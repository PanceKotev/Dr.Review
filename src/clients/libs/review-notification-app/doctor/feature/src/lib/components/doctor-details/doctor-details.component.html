<mat-card *ngIf="doctor">
  <mat-card-title
    >Детали за {{ doctor.firstName }} {{ doctor.lastName }}</mat-card-title
  >
  <mat-card-content>
    <div class="details-content">
      <div class="doctor-summary">
        <drreview-summary
          *ngIf="doctorReviewSummary"
          [summaryScore]="doctorReviewSummary.rating"
          [starByCount]="doctorReviewSummary.reviewCountByStar"
        ></drreview-summary>
      </div>
      <div class="doctor-details">
        <div class="field">
          <div>Локација</div>
          <div>{{ doctor.location }}</div>
        </div>
        <div class="field">
          <div>Специјализација</div>
          <div>{{ doctor.specialization }}</div>
        </div>
        <div class="field">
          <div>Институција</div>
          <div>{{ doctor.institution }}</div>
        </div>
      </div>
    </div>
  </mat-card-content>
  <div class="new-comment-wrapper">
    <drreview-create-review
      *ngIf="!currentUserReview"
      class="current-user-review"
      (reviewCreate)="handleCreateReview($event)"
    >
    </drreview-create-review>
  </div>

  <div class="reviews" *ngIf="currentUserReview || doctorReviews?.length">
    <drreview-review
      *ngIf="currentUserReview"
      [createdBy]="currentUserReview.reviewerName"
      [text]="currentUserReview.comment ?? ''"
      [givenRating]="currentUserReview.score"
      [numberOfLikes]="currentUserReview.upvotes"
      [numberOfDislikes]="currentUserReview.downvotes"
      [previousVote]="currentUserReview.previousUserVote"
      (reviewVotedOn)="handleReviewVote(currentUserReview.suid, $event)"
      (reviewChanged)="handleReviewChanged(currentUserReview.suid, $event)"
      (deletedReview)="handleReviewDelete(currentUserReview.suid)"
      [isEditable]="true"
    >
    </drreview-review>
    <drreview-review
      *ngFor="let review of doctorReviews"
      [createdBy]="review.reviewerName"
      [text]="review.comment ?? ''"
      [givenRating]="review.score"
      [numberOfLikes]="review.upvotes"
      [numberOfDislikes]="review.downvotes"
      [previousVote]="review.previousUserVote"
      (reviewVotedOn)="handleReviewVote(review.suid, $event)"
      (reviewChanged)="handleReviewChanged(review.suid, $event)"
      (deletedReview)="handleReviewDelete(review.suid)"
      [isEditable]="false"
    ></drreview-review>
  </div>
</mat-card>
